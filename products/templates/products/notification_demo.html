{% extends 'products/base.html' %}
{% load static %}

{% block title %}Demostraci√≥n - Inversi√≥n de Dependencias{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h2 class="mb-0">üîÑ Demostraci√≥n: Inversi√≥n de Dependencias</h2>
                    <small>Sistema de Notificaciones Flexible - Principios SOLID</small>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-8">
                            <h4>üéØ Objetivo de la Demostraci√≥n</h4>
                            <p class="lead">
                                Esta p√°gina demuestra c√≥mo el <strong>principio de Inversi√≥n de Dependencias (DIP)</strong> 
                                permite que el mismo c√≥digo funcione con diferentes implementaciones de notificaciones 
                                sin modificar la l√≥gica principal.
                            </p>
                            
                            <div class="alert alert-info">
                                <h5>üìö ¬øQu√© es Inversi√≥n de Dependencias?</h5>
                                <ul class="mb-0">
                                    <li><strong>Antes:</strong> C√≥digo depend√≠a de EmailNotifier espec√≠fico</li>
                                    <li><strong>Despu√©s:</strong> C√≥digo depende de NotificationInterface abstracta</li>
                                    <li><strong>Beneficio:</strong> Podemos cambiar notificadores sin tocar el c√≥digo cliente</li>
                                </ul>
                            </div>

                            <form method="post" class="mt-4">
                                {% csrf_token %}
                                <div class="form-group">
                                    <label for="message"><strong>üí¨ Mensaje de Prueba:</strong></label>
                                    <textarea 
                                        name="message" 
                                        id="message" 
                                        class="form-control" 
                                        rows="3" 
                                        placeholder="Escribe un mensaje para probar el sistema de notificaciones..."
                                    >¬°Hola! Este es un mensaje de prueba del sistema de notificaciones con Inversi√≥n de Dependencias.</textarea>
                                </div>

                                <div class="form-group">
                                    <label><strong>üì° Selecciona Configuraci√≥n de Notificadores:</strong></label>
                                    <div class="row mt-2">
                                        <div class="col-md-6">
                                            <div class="custom-control custom-radio">
                                                <input type="radio" id="default" name="channel" value="default" class="custom-control-input" checked>
                                                <label class="custom-control-label" for="default">
                                                    <strong>üîß Configuraci√≥n Autom√°tica</strong><br>
                                                    <small class="text-muted">El sistema decide los mejores canales</small>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="custom-control custom-radio">
                                                <input type="radio" id="email" name="channel" value="email" class="custom-control-input">
                                                <label class="custom-control-label" for="email">
                                                    <strong>üìß Solo Email</strong><br>
                                                    <small class="text-muted">Notificaci√≥n √∫nicamente por correo</small>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-6">
                                            <div class="custom-control custom-radio">
                                                <input type="radio" id="whatsapp" name="channel" value="whatsapp" class="custom-control-input">
                                                <label class="custom-control-label" for="whatsapp">
                                                    <strong>üì± WhatsApp + Log</strong><br>
                                                    <small class="text-muted">WhatsApp con fallback a log</small>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="custom-control custom-radio">
                                                <input type="radio" id="multi" name="channel" value="multi" class="custom-control-input">
                                                <label class="custom-control-label" for="multi">
                                                    <strong>üöÄ Multi-Canal</strong><br>
                                                    <small class="text-muted">Todos los canales con fallbacks</small>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary btn-lg">
                                    üîî Probar Notificaci√≥n
                                </button>
                            </form>
                        </div>

                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-header">
                                    <h5>üèóÔ∏è Arquitectura Implementada</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <h6 class="text-primary">üìã Abstracci√≥n</h6>
                                        <code>NotificationInterface</code>
                                        <small class="d-block text-muted">Define el contrato</small>
                                    </div>

                                    <div class="mb-3">
                                        <h6 class="text-success">üîß Implementaciones</h6>
                                        <ul class="list-unstyled small">
                                            <li>‚Ä¢ <code>EmailNotifier</code></li>
                                            <li>‚Ä¢ <code>WhatsAppNotifier</code></li>
                                            <li>‚Ä¢ <code>InAppNotifier</code></li>
                                            <li>‚Ä¢ <code>LogNotifier</code></li>
                                        </ul>
                                    </div>

                                    <div class="mb-3">
                                        <h6 class="text-warning">‚öôÔ∏è Gestor</h6>
                                        <code>NotificationManager</code>
                                        <small class="d-block text-muted">Coordina notificadores</small>
                                    </div>

                                    <div>
                                        <h6 class="text-info">üéØ Servicio</h6>
                                        <code>NotificationService</code>
                                        <small class="d-block text-muted">API de alto nivel</small>
                                    </div>
                                </div>
                            </div>

                            <div class="card bg-light mt-3">
                                <div class="card-header">
                                    <h5>‚úÖ Beneficios del DIP</h5>
                                </div>
                                <div class="card-body">
                                    <ul class="list-unstyled small">
                                        <li class="mb-2">
                                            <span class="badge badge-success">Flexibilidad</span><br>
                                            Cambiar notificadores sin tocar c√≥digo
                                        </li>
                                        <li class="mb-2">
                                            <span class="badge badge-info">Testabilidad</span><br>
                                            F√°cil crear mocks para pruebas
                                        </li>
                                        <li class="mb-2">
                                            <span class="badge badge-warning">Extensibilidad</span><br>
                                            Agregar nuevos canales f√°cilmente
                                        </li>
                                        <li>
                                            <span class="badge badge-primary">Mantenibilidad</span><br>
                                            C√≥digo m√°s limpio y modular
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="mb-0">üîç C√≥digo de Ejemplo - Inversi√≥n de Dependencias</h5>
                                </div>
                                <div class="card-body">
                                    <h6>‚ùå Antes (Sin DIP):</h6>
                                    <pre class="bg-light p-2 rounded"><code>class CommentService:
    def notify_comment(self, comment):
        # Acoplado a implementaci√≥n espec√≠fica
        email_sender = EmailSender()  # ‚ùå Dependencia concreta
        email_sender.send(comment.product.seller.email, "Nuevo comentario")</code></pre>

                                    <h6 class="mt-3">‚úÖ Despu√©s (Con DIP):</h6>
                                    <pre class="bg-light p-2 rounded"><code>class NotificationManager:
    def __init__(self, notifier: NotificationInterface):  # ‚úÖ Dependencia abstracta
        self.notifier = notifier
    
    def send_notification(self, user, message):
        return self.notifier.send_notification(user, message)

# Uso flexible:
email_notifier = EmailNotifier()
whatsapp_notifier = WhatsAppNotifier()
manager = NotificationManager(email_notifier)  # ‚úÖ Inyecci√≥n de dependencia</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.custom-control-label {
    cursor: pointer;
}

pre code {
    font-size: 0.85em;
}

.badge {
    font-size: 0.75em;
}

.alert-info {
    border-left: 4px solid #17a2b8;
}
</style>
{% endblock %}